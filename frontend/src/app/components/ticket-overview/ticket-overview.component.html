<div class="TicketWindow">
  <div class="TicketHeader">
    <button (click)="showTicketForm = true" class="TicketButton">+ Ticket anlegen</button>
    <h2>Tickets</h2>
  </div>
  <table class="TicketTable">
    <thead>
      <tr>
        <th><input type="checkbox" [(ngModel)]="allSelected" (change)="toggleAll()"></th>
        <th>ID</th>
        <th>Kurztext</th>
        <th>Typ</th>
        <th>Kategorie</th>
        <th>Status</th>
        <th>Erstellt am</th>
        <th>Frist</th>
        <th>Verantwortlicher</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let ticket of tickets" [class.selected]="ticket === selectedTicket" (click)="selectTicket(ticket)">
        <td><input type="checkbox" [(ngModel)]="ticket.selected"></td>
        <td>{{ticket.id}}</td>
        <td>{{ticket.shortText}}</td>
        <td>{{ticket.type}}</td>
        <td>{{ticket.category}}</td>
        <td>{{ticket.status}}</td>
        <td>{{ticket.created | date:'dd.MM.yyyy'}}</td>
        <td>{{ticket.due | date:'dd.MM.yyyy'}}</td>
        <td>{{ticket.responsible}}</td>
      </tr>
    </tbody>
  </table>

  <button class="TicketButton" (click)="exportSelected()">Exportieren</button>

  <!-- Detailansicht für ausgewähltes Ticket -->
  <div *ngIf="selectedTicket" class="TicketDetail">
    <h3>Ticket Detail ({{selectedTicket.id}})</h3>
    <div><b>Kurztext:</b> {{selectedTicket.shortText}}</div>
    <div><b>Typ:</b> {{selectedTicket.type}}</div>
    <div><b>Kategorie:</b> {{selectedTicket.category}}</div>
    <div><b>Status:</b> {{selectedTicket.status}}</div>
    <div><b>Beschreibung:</b> {{selectedTicket.description}}</div>
    <div><b>Verantwortlicher:</b> {{selectedTicket.responsible}}</div>
    <div><b>Erstellt am:</b> {{selectedTicket.created | date:'dd.MM.yyyy'}}</div>
    <div><b>Frist:</b> {{selectedTicket.due | date:'dd.MM.yyyy'}}</div>
    <button class="TicketButton" (click)="selectedTicket = null">Schließen</button>
  </div>

  <!-- Ticket anlegen Formular -->
  <div *ngIf="showTicketForm" class="TicketForm">
    <h3>Neues Ticket</h3>
    <input class="TicketInput" placeholder="Kurztext" [(ngModel)]="newTicket.shortText">
    <input class="TicketInput" placeholder="Typ" [(ngModel)]="newTicket.type">
    <input class="TicketInput" placeholder="Kategorie" [(ngModel)]="newTicket.category">
    <input class="TicketInput" placeholder="Beschreibung" [(ngModel)]="newTicket.description">
    <input class="TicketInput" placeholder="Status" [(ngModel)]="newTicket.status">
    <input class="TicketInput" placeholder="Verantwortlicher" [(ngModel)]="newTicket.responsible">
    <input class="TicketInput" type="date" [(ngModel)]="newTicket.due">
    <button class="TicketButton" (click)="addTicket()">Speichern</button>
    <button class="TicketButton" (click)="showTicketForm = false">Abbrechen</button>
  </div>
</div>
